<html>
<body>

        {% include "company/header.html" %}
<h1 class="text-center"> All Departments </h1>
<a href="{% url 'new_department' %}" class="btn btn-primary">New Department<span class="glyphicon glyphicon-plus"></span></a>
</br>
</br>

<div class="col-lg-12">
        <div class="table-responsive">
            <table class="table table-bordered table-hover table-striped tablesorter">
                <thead>
                <tr>
                  <th class="header"> Code <i class="icon-sort"></i></th>
                  <th class="header"> Name <i class="icon-sort"></i></th>
                  <th class="header"> Actions <i class="icon-sort"></i></th>                  
              
                </tr>
            </thead>
            <tbody>
            
            {% for key in departments %}
                <tr>
                    <td>{{ key.code }}</td>
                    <td>{{ key.name }}</td>
                    <td><a class="btn btn-default" href="{% url 'dept_edit' key.id  %}">Edit<span class="glyphicon glyphicon-pencil"></span></a>
                    
                    <a class="btn btn-default delete" value="{{key.id}}">Delete<span class="glyphicon glyphicon-pencil"></span></a>
                    </td>
                </tr>
            {% endfor %}
            
            </tbody>
            </table>
        </div>
    </div>
</body>
<script>
    $(".delete").click(function () {
     
      dep_id=$(this).attr('value');
       tr = $(this).closest('tr');
    $.ajax({
    url: '/comapny/department/',
    data: {pk: dep_id },
    dataType: 'json',
    success: function() {
        $(tr).remove();

        alert('Department deleted!')
    }
});
});
</script>
</html>